"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ScanSettings=void 0;var tslib_1=require("tslib");var __1=require("..");var barcode_1=require("./barcode");var logger_1=require("./logger");var symbologySettings_1=require("./symbologySettings");var textRecognitionSettings_1=require("./textRecognitionSettings");var ScanSettings=function(){function e(t){var o=t===void 0?{}:t,i=o.textRecognitionSettings,r=i===void 0?new textRecognitionSettings_1.TextRecognitionSettings:i,n=o.recognitionMode,s=n===void 0?e.RecognitionMode.CODE:n,a=o.enabledSymbologies,c=a===void 0?[]:a,g=o.codeDuplicateFilter,h=g===void 0?0:g,l=o.maxNumberOfCodesPerFrame,y=l===void 0?1:l,u=o.searchArea,d=u===void 0?{x:0,y:0,width:1,height:1}:u,b=o.gpuAcceleration,p=b===void 0?true:b,S=o.blurryRecognition,m=S===void 0?true:S,f=o.codeDirectionHint,v=f===void 0?e.CodeDirection.LEFT_TO_RIGHT:f,x=o.deviceName;this.symbologySettings=new Map;this.textRecognitionSettings=r;this.setRecognitionMode(s);this.enableSymbologies(c);this.codeDuplicateFilter=h;this.maxNumberOfCodesPerFrame=y;this.baseSearchArea={x:0,y:0,width:1,height:1};this.searchArea=d;this.gpuAcceleration=p;this.blurryRecognition=m;this.codeDirectionHint=v;this.deviceName=x;this.properties=new Map([["advanced_localization",0]])}e.prototype.toJSONString=function(){var e={};this.symbologySettings.forEach(function(t,o){e[barcode_1.Barcode.Symbology.toJSONName(o)]=t});var t={};this.properties.forEach(function(e,o){t[o]=e});var o={x:Math.max(0,Math.min(1,this.baseSearchArea.x+this.searchArea.x*this.baseSearchArea.width)),y:Math.max(0,Math.min(1,this.baseSearchArea.y+this.searchArea.y*this.baseSearchArea.height)),width:Math.max(0,Math.min(1,this.baseSearchArea.width*this.searchArea.width)),height:Math.max(0,Math.min(1,this.baseSearchArea.height*this.searchArea.height))};var i=Math.round(o.x*100)===0&&Math.round(o.y*100)===0&&Math.round(o.width*100)===100&&Math.round(o.height*100)===100;return JSON.stringify({textRecognitionSettings:this.textRecognitionSettings.toJSONString(),recognitionMode:this.recognitionMode,symbologies:e,codeDuplicateFilter:this.codeDuplicateFilter,maxNumberOfCodesPerFrame:this.maxNumberOfCodesPerFrame,searchArea:o,codeLocation1d:i?undefined:{area:{x:o.x,y:o.y+o.height*.75/2,width:o.width,height:o.height*.25}},codeLocation2d:i?undefined:{area:o},gpuAcceleration:this.gpuAcceleration,blurryRecognition:this.blurryRecognition,codeDirectionHint:this.codeDirectionHint,properties:t})};e.prototype.getTextRecognitionSettings=function(){return this.textRecognitionSettings};e.prototype.setTextRecognitionSettings=function(e){this.textRecognitionSettings=e;return this};e.prototype.getRecognitionMode=function(){return this.recognitionMode};e.prototype.setRecognitionMode=function(e){this.recognitionMode=e;if(e.includes("text")&&!__1.textRecognition){logger_1.Logger.log(logger_1.Logger.Level.WARN,"The library has not been configured to load text recognition (ScanditSDK.configure() - loadTextRecognition option): ScanSettings' recognition mode for text will be ignored")}return this};e.prototype.getSymbologySettings=function(e){if(this.symbologySettings.has(e)){return this.symbologySettings.get(e)}else{if(e in barcode_1.Barcode.Symbology||Object.values(barcode_1.Barcode.Symbology).includes(e)){this.symbologySettings.set(e,new symbologySettings_1.SymbologySettings(e));return this.symbologySettings.get(e)}else{throw new TypeError('Invalid symbology "'.concat(e,'"'))}}};e.prototype.isSymbologyEnabled=function(e){return this.symbologySettings.has(e)&&this.symbologySettings.get(e).isEnabled()};e.prototype.enableSymbologies=function(e){return this.setSymbologiesEnabled(e,true)};e.prototype.disableSymbologies=function(e){return this.setSymbologiesEnabled(e,false)};e.prototype.getCodeDuplicateFilter=function(){return this.codeDuplicateFilter};e.prototype.setCodeDuplicateFilter=function(e){this.codeDuplicateFilter=e;return this};e.prototype.getMaxNumberOfCodesPerFrame=function(){return this.maxNumberOfCodesPerFrame};e.prototype.setMaxNumberOfCodesPerFrame=function(e){this.maxNumberOfCodesPerFrame=e;return this};e.prototype.getSearchArea=function(){return this.searchArea};e.prototype.setSearchArea=function(e){this.searchArea=e;return this};e.prototype.getBaseSearchArea=function(){return this.baseSearchArea};e.prototype.setBaseSearchArea=function(e){this.baseSearchArea=e;return this};e.prototype.isGpuAccelerationEnabled=function(){return this.gpuAcceleration};e.prototype.setGpuAccelerationEnabled=function(e){this.gpuAcceleration=e;return this};e.prototype.isBlurryRecognitionEnabled=function(){return this.blurryRecognition};e.prototype.setBlurryRecognitionEnabled=function(e){this.blurryRecognition=e;return this};e.prototype.getCodeDirectionHint=function(){return this.codeDirectionHint};e.prototype.setCodeDirectionHint=function(e){this.codeDirectionHint=e;return this};e.prototype.getDeviceName=function(){return this.deviceName};e.prototype.setDeviceName=function(e){this.deviceName=e;return this};e.prototype.getProperty=function(e){if(this.properties.has(e)){return this.properties.get(e)}return-1};e.prototype.setProperty=function(e,t){this.properties.set(e,t);return this};e.prototype.setSingleSymbologyEnabled=function(e,t){if(e in barcode_1.Barcode.Symbology||Object.values(barcode_1.Barcode.Symbology).includes(e)){if(this.symbologySettings.has(e)){this.symbologySettings.get(e).setEnabled(t)}else{this.symbologySettings.set(e,new symbologySettings_1.SymbologySettings(e,t))}}else{throw new TypeError('Invalid symbology "'.concat(e,'"'))}};e.prototype.setMultipleSymbologiesEnabled=function(e,t){var o,i,r,n;try{for(var s=(0,tslib_1.__values)(e),a=s.next();!a.done;a=s.next()){var c=a.value;if(!(c in barcode_1.Barcode.Symbology||Object.values(barcode_1.Barcode.Symbology).includes(c))){throw new TypeError('Invalid symbology "'.concat(c,'"'))}}}catch(e){o={error:e}}finally{try{if(a&&!a.done&&(i=s.return))i.call(s)}finally{if(o)throw o.error}}try{for(var g=(0,tslib_1.__values)(e),h=g.next();!h.done;h=g.next()){var c=h.value;if(this.symbologySettings.has(c)){this.symbologySettings.get(c).setEnabled(t)}else{this.symbologySettings.set(c,new symbologySettings_1.SymbologySettings(c,t))}}}catch(e){r={error:e}}finally{try{if(h&&!h.done&&(n=g.return))n.call(g)}finally{if(r)throw r.error}}};e.prototype.setSymbologiesEnabled=function(e,t){if(typeof e==="object"){this.setMultipleSymbologiesEnabled(e,t)}else{this.setSingleSymbologyEnabled(e,t)}return this};return e}();exports.ScanSettings=ScanSettings;(function(e){var t;(function(e){e["CODE"]="code";e["TEXT"]="text";e["CODE_AND_TEXT"]="code-and-text"})(t=e.RecognitionMode||(e.RecognitionMode={}));var o;(function(e){e["LEFT_TO_RIGHT"]="left-to-right";e["RIGHT_TO_LEFT"]="right-to-left";e["BOTTOM_TO_TOP"]="bottom-to-top";e["TOP_TO_BOTTOM"]="top-to-bottom";e["HORIZONTAL"]="horizontal";e["VERTICAL"]="vertical";e["NONE"]="none"})(o=e.CodeDirection||(e.CodeDirection={}))})(ScanSettings=exports.ScanSettings||(exports.ScanSettings={}));exports.ScanSettings=ScanSettings;