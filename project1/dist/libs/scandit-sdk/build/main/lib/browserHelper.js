"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BrowserHelper=exports.UAParser=void 0;var tslib_1=require("tslib");var js_cookie_1=(0,tslib_1.__importDefault)(require("js-cookie"));var ua_parser_js_1=(0,tslib_1.__importDefault)(require("ua-parser-js"));exports.UAParser=ua_parser_js_1.default;var browserCompatibility_1=require("./browserCompatibility");var BrowserHelper;(function(e){e.userAgentInfo=new ua_parser_js_1.default(navigator.userAgent);e.canvas=document.createElement("canvas");function r(){var e;if("orientation"in window){return false}else{var r="(any-pointer: coarse)";var t=(e=window.matchMedia)===null||e===void 0?void 0:e.call(window,r);if(navigator.maxTouchPoints===0||(t===null||t===void 0?void 0:t.media)===r&&(t===null||t===void 0?void 0:t.matches)===false){return true}else{return false}}}e.isDesktopDevice=r;function t(){function r(e,t,i){var o=e[t[0]];if(o==null){return false}if(t.length===1){return typeof o===i}else{return(typeof o==="function"||typeof o==="object")&&r(o,t.slice(1),i)}}function t(e){return e.name==="iOS"&&e.version!=null&&["11.2.2","11.2.5","11.2.6"].includes(e.version)}var i=true;var o=true;var a=[];if(!location.protocol.startsWith("http")){a.push(browserCompatibility_1.BrowserCompatibility.Feature.HTTP_PROTOCOL);i=o=false}if(r(window,["isSecureContext"],"boolean")&&window.isSecureContext===false){a.push(browserCompatibility_1.BrowserCompatibility.Feature.SECURE_CONTEXT)}if(!r(navigator,["mediaDevices","getUserMedia"],"function")&&!r(navigator,["enumerateDevices"],"function")&&!r(window,["MediaStreamTrack","getSources"],"function")){a.push(browserCompatibility_1.BrowserCompatibility.Feature.MEDIA_DEVICES);i=false}if(!r(window,["Worker"],"function")){a.push(browserCompatibility_1.BrowserCompatibility.Feature.WEB_WORKERS);i=o=false}if(!r(window,["WebAssembly"],"object")){a.push(browserCompatibility_1.BrowserCompatibility.Feature.WEB_ASSEMBLY);i=o=false}if(!r(window,["Blob"],"function")){a.push(browserCompatibility_1.BrowserCompatibility.Feature.BLOB);i=o=false}if(!r(window,["URL","createObjectURL"],"function")){a.push(browserCompatibility_1.BrowserCompatibility.Feature.URL_OBJECT);i=o=false}if(!r(window,["OffscreenCanvas"],"function")){a.push(browserCompatibility_1.BrowserCompatibility.Feature.OFFSCREEN_CANVAS)}try{if(!r(window,["WebGLRenderingContext"],"function")||e.canvas.getContext("webgl")==null&&e.canvas.getContext("experimental-webgl")==null){throw new Error}}catch(e){a.push(browserCompatibility_1.BrowserCompatibility.Feature.WEBGL)}var n=e.userAgentInfo.getOS();if(t(n)){a.push(browserCompatibility_1.BrowserCompatibility.Feature.WEB_ASSEMBLY_ERROR_FREE);i=o=false}return{fullSupport:i,scannerSupport:o,missingFeatures:a}}e.checkBrowserCompatibility=t;function i(){var e="scandit-device-id";var r=localStorage.getItem(e);if(r!=null&&r!==""){return r}r=js_cookie_1.default.get(e);if(r!=null&&r!==""){localStorage.setItem(e,r);return r}var t=new Uint8Array(20);crypto.getRandomValues(t);r=Array.from(t).map(function(e){var r=e.toString(16);return r.length===1?"0".concat(r):r}).join("");localStorage.setItem(e,r);return r}e.getDeviceId=i;function o(e){return e instanceof HTMLElement||e!=null&&typeof e==="object"&&typeof e.tagName==="string"}e.isValidHTMLElement=o})(BrowserHelper=exports.BrowserHelper||(exports.BrowserHelper={}));