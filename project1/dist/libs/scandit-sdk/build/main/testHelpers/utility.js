"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fakeFullCompatibleBrowser=exports.fakeGetCameras=exports.wait=void 0;var tslib_1=require("tslib");var eventemitter3_1=require("eventemitter3");var sinon=(0,tslib_1.__importStar)(require("sinon"));var __1=require("..");function wait(e){return(0,tslib_1.__awaiter)(this,void 0,void 0,function(){return(0,tslib_1.__generator)(this,function(t){return[2,new Promise(function(t){setTimeout(t,e)})]})})}exports.wait=wait;function fakeGetCameras(e,t,r){var i,n;(n=(i=__1.CameraAccess.getCameras).restore)===null||n===void 0?void 0:n.call(i);sinon.stub(__1.CameraAccess,"getCameras").resolves(Array.from(Array(e),function(e,i){var n,s;var o=(n=t===null||t===void 0?void 0:t[i])!==null&&n!==void 0?n:__1.Camera.Type.BACK;return{deviceId:(i+1).toString(),label:(s=r===null||r===void 0?void 0:r[i])!==null&&s!==void 0?s:"Fake Camera Device (".concat(o,")"),cameraType:o}}))}exports.fakeGetCameras=fakeGetCameras;function fakeFullCompatibleBrowser(e,t){if(e===void 0){e=true}if(t===void 0){t=[]}return(0,tslib_1.__awaiter)(this,void 0,void 0,function(){var r,i,n;return(0,tslib_1.__generator)(this,function(s){switch(s.label){case 0:r={stop:sinon.stub(),addEventListener:sinon.stub(),removeEventListener:sinon.stub(),applyConstraints:sinon.stub().resolves(),getCapabilities:sinon.stub().returns({}),getConstraints:sinon.stub().returns({}),getSettings:function(){return{width:4,height:4}}};i=function(e){(0,tslib_1.__extends)(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(eventemitter3_1.EventEmitter);n=new eventemitter3_1.EventEmitter;Object.defineProperty(navigator,"mediaDevices",{value:{getUserMedia:function(){return Promise.resolve({getTracks:function(){return[r]},getVideoTracks:function(){return[r]}})},addEventListener:function(e,t){n.removeAllListeners(e);n.on(e,t)},dispatchEvent:function(e){n.emit(e.type);return true}},configurable:true});navigator.mediaDevices.enumerateDevices=function(){return Promise.resolve(t)};URL.createObjectURL=sinon.stub();__1.BrowserHelper.checkBrowserCompatibility=function(){return{fullSupport:true,scannerSupport:true,missingFeatures:[]}};if(!e)return[3,2];return[4,(0,__1.configure)("#".repeat(64),{preloadBlurryRecognition:false,preloadEngine:false})];case 1:s.sent();s.label=2;case 2:return[2]}})})}exports.fakeFullCompatibleBrowser=fakeFullCompatibleBrowser;