import{deviceId,highEndBlurryRecognition,scanditDataCaptureLocation,textRecognition,userLicenseKey}from"../index";import{BrowserHelper}from"./browserHelper";import{dataCaptureWorkerBlob}from"./workers/dataCaptureWorker";export class DataCaptureLoader{preloadedDataCaptureWorker;preloadedDataCaptureWorkerAvailable;constructor(e){if(e){this.preloadedDataCaptureWorker=new Worker(URL.createObjectURL(dataCaptureWorkerBlob));DataCaptureLoader.load(this.preloadedDataCaptureWorker)}this.preloadedDataCaptureWorkerAvailable=e}static load(e,r=false,a=false){e.postMessage({type:"load-library",deviceId:deviceId,libraryLocation:scanditDataCaptureLocation,path:window.location.pathname,preload:r,delayedRegistration:a,highEndBlurryRecognition:highEndBlurryRecognition,textRecognition:textRecognition,licenseKey:userLicenseKey,deviceModelName:BrowserHelper.userAgentInfo.getDevice().model})}getDataCaptureWorker(){if(this.preloadedDataCaptureWorkerAvailable&&this.preloadedDataCaptureWorker!=null){this.preloadedDataCaptureWorkerAvailable=false;return this.preloadedDataCaptureWorker}else{return new Worker(URL.createObjectURL(dataCaptureWorkerBlob))}}returnDataCaptureWorker(e){if(this.preloadedDataCaptureWorker==null){this.preloadedDataCaptureWorker=e}if(this.preloadedDataCaptureWorker===e){this.preloadedDataCaptureWorker.onmessage=null;this.preloadedDataCaptureWorker.postMessage({type:"reset"});this.preloadedDataCaptureWorkerAvailable=true}else{e.terminate()}}}